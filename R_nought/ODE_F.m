

function[n]=ODE_F(par,times, ini_state, N)

f=@(t,n) [-(((par(1)*(n(3)+n(4)+n(5)+n(6)+n(7)))) + ((par(2)*(n(14)+n(15)+n(16)+n(17)+n(18)))))*(n(1)/N(1));...
    (((par(1)*(n(3)+n(4)+n(5)+n(6)+n(7)))) + ((par(2)*(n(14)+n(15)+n(16)+n(17)+n(18)))))*(n(1)/N(1))-...
    par(5)*n(2);...
    (par(5)*(1-par(6))*n(2))- (par(7)*n(3));...
    (par(7)*n(3))-(par(8)*n(4));...
    (par(5)*par(6)*n(2))-(par(9)*n(5));...
    (par(9)*par(10)*n(5))-(par(12)*n(6));...
    (par(9)*(1-par(10))*n(5))-((par(12)+par(11))*n(7));...
    (par(12)*n(7))-((par(13)+par(11))*n(8));...
    (par(12)*n(6))-(par(13)*n(9));...
    par(8)*n(4);...
    par(13)*(n(9)+n(8));...
    -(((par(3)*(n(3)+n(4)+n(5)+n(6)+n(7)))) + ((par(4)*(n(14)+n(15)+n(16)+n(17)+n(18)))))*(n(12)/N(2));...
    (((par(3)*(n(3)+n(4)+n(5)+n(6)+n(7)))) + ((par(4)*(n(14)+n(15)+n(16)+n(17)+n(18)))))*(n(12)/N(2))-...
    par(5)*n(13);...
    (par(5)*(1-par(6))*n(13))- (par(7)*n(14));...
    (par(7)*n(14))-(par(8)*n(15));...
    (par(5)*par(6)*n(13))-(par(9)*n(16));...
    (par(9)*par(10)*n(16))-(par(12)*n(17));...
    (par(9)*(1-par(10))*n(16))-((par(12)+par(11))*n(18));...
    (par(12)*n(18))-((par(13)+par(14))*n(19));...
    (par(12)*n(17))-(par(13)*n(20));...
    par(8)*n(15);...
    par(13)*(n(20)+n(19))];

[~,n]=ode45(f,times,ini_state);

end